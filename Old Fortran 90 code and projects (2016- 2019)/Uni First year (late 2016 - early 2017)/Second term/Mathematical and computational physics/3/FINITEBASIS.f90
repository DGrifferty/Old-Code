PROGRAM FINITEMAINPART

REAL:: X, Y, H, YatX, YatXplusH
REAL, EXTERNAL:: Fx, Dforxh

INTERFACE 
FUNCTION Fx(X)
REAL, INTENT(IN) :: X
REAL:: Fx, YatX, YatXplusH
END FUNCTION  Fx
END INTERFACE

INTERFACE 
FUNCTION DForxh(X, H)
REAL, INTENT(IN) :: H
REAL:: DForxh, YatX, YatXplusH, X
REAL, EXTERNAL:: Fx
END FUNCTION DForxh
END INTERFACE

H=2


READ(5,*) X
WRITE(6,*)  Fx(X)
WRITE(6,*) DForxh(X, H)
END PROGRAM


FUNCTION Fx(X)
IMPLICIT NONE
REAL, INTENT (IN) :: X
REAL:: Fx

Fx=1/(X**2.0+3.0*X+2)

END FUNCTION Fx




FUNCTION DForxh(X, H)
IMPLICIT NONE 
REAL, INTENT(IN) :: H
REAL, EXTERNAL:: Fx
REAL:: DForxh, YatX, YatXplusH, X
YatX= Fx(X)
X=X+H
YatXplusH=Fx(X)
Dforxh=(YatXplusH-YatX)/H
END FUNCTION DForxh